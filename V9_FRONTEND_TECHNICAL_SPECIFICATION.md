# üìã V9 Analytics - Frontend Technical Specification
## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –û—Å–Ω–æ–≤–Ω—ã–µ –°—Ç—Ä–∞–Ω–∏—Ü—ã
### 23 –æ–∫—Ç—è–±—Ä—è 2025

---

## üéØ –¶–ï–õ–¨

–°–æ–∑–¥–∞—Ç—å 4 –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç **–ü–û–õ–ù–£–Æ –∞—Ç—Ä–∏–±—É—Ü–∏—é –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤** —Å —É—á–µ—Ç–æ–º **–í–°–ï–• –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** (Google, Facebook, Instagram, Email, Viber, Telegram, Events) –Ω–∞ –æ—Å–Ω–æ–≤–µ V9 –ª–æ–≥–∏–∫–∏.

---

## üìÑ –°–¢–†–ê–ù–ò–¶–´

### 1. `/analytics/ads` - –†–µ–∫–ª–∞–º–∞ (Google Ads + Facebook/Meta Ads)
### 2. `/analytics/data-analytics` - –û–±—â–∞—è –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (Dashboard)
### 3. `/analytics/contracts` - –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏ –ê—Ç—Ä–∏–±—É—Ü–∏—è
### 4. `/analytics/marketing` - –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ (–í—Å–µ –ò—Å—Ç–æ—á–Ω–∏–∫–∏)

---

# 1Ô∏è‚É£ PAGE: `/analytics/ads` - –†–µ–∫–ª–∞–º–∞

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –ø–ª–∞—Ç–Ω—ã–º —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º (Google Ads, Facebook Ads, Instagram Ads)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –°—Ç—Ä–∞–Ω–∏—Ü—ã

### üìä Section 1: KPI Cards (Top)

**4 –∫–∞—Ä—Ç–æ—á–∫–∏**:

1. **Total Spend**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: —Å—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ (UAH)
   - –ü–µ—Ä–∏–æ–¥: –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ vs –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–µ—Ä–∏–æ–¥
   - –¶–≤–µ—Ç: —Å–∏–Ω–∏–π

2. **Total Contracts**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
   - –ü–µ—Ä–∏–æ–¥: –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ vs –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–µ—Ä–∏–æ–¥
   - –¶–≤–µ—Ç: –∑–µ–ª–µ–Ω—ã–π

3. **Total Revenue**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: —Å—É–º–º–∞ revenue (UAH)
   - –ü–µ—Ä–∏–æ–¥: –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ vs –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–µ—Ä–∏–æ–¥
   - –¶–≤–µ—Ç: —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π

4. **ROAS**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: Revenue / Spend
   - –§–æ—Ä–º–∞—Ç: 1.2x, 5.5x, etc.
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ vs –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–µ—Ä–∏–æ–¥
   - –¶–≤–µ—Ç: –æ—Ä–∞–Ω–∂–µ–≤—ã–π (–∑–µ–ª–µ–Ω—ã–π –µ—Å–ª–∏ >3x, –∫—Ä–∞—Å–Ω—ã–π –µ—Å–ª–∏ <1x)

### üìà Section 2: Charts

**Chart 1: Spend, Revenue, Contracts –ø–æ –¥–Ω—è–º (Line Chart)**
- X-axis: –¥–∞—Ç–∞
- Y-axis (left): Spend (UAH), Revenue (UAH)
- Y-axis (right): Contracts (count)
- Lines: 3 –ª–∏–Ω–∏–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏
- –õ–µ–≥–µ–Ω–¥–∞: –≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞
- Tooltip: –¥–∞—Ç–∞, spend, revenue, contracts, ROAS

**Chart 2: ROAS Trend (Area Chart)**
- X-axis: –¥–∞—Ç–∞
- Y-axis: ROAS (x)
- Area fill: gradient (green to yellow to red)
- Benchmark line: ROAS = 3x (dotted line)
- Tooltip: –¥–∞—Ç–∞, ROAS, contracts, revenue, spend

**Chart 3: Contracts by Platform (Pie Chart)**
- Slices: Google, Facebook, Instagram
- Values: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- Tooltip: platform, contracts, % –æ—Ç total
- Colors: Google (blue), Facebook (dark blue), Instagram (pink)

### üìã Section 3: Campaign Performance Table

**Columns**:
1. Platform (Google / Facebook / Instagram) - —Å –∏–∫–æ–Ω–∫–æ–π
2. Campaign Name - –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏)
3. Spend (UAH) - –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é DESC
4. Impressions - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–æ —Å K, M
5. Clicks - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–æ —Å K, M
6. CTR (%) - —Ü–≤–µ—Ç: –∑–µ–ª–µ–Ω—ã–π >2%, –∂–µ–ª—Ç—ã–π 1-2%, –∫—Ä–∞—Å–Ω—ã–π <1%
7. Leads - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏–¥–æ–≤
8. CPL (UAH) - Cost Per Lead
9. Contracts - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
10. Revenue (UAH) - –≤—ã—Ä—É—á–∫–∞
11. ROAS (x) - —Ü–≤–µ—Ç: –∑–µ–ª–µ–Ω—ã–π >3x, –∂–µ–ª—Ç—ã–π 1-3x, –∫—Ä–∞—Å–Ω—ã–π <1x
12. Actions - –∫–Ω–æ–ø–∫–∏ (View Details, Edit, Pause)

**Features**:
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º
- –§–∏–ª—å—Ç—Ä—ã: Platform, Date Range, Campaign Name (search)
- Pagination: 10, 25, 50, 100 –∑–∞–ø–∏—Å–µ–π
- Export: CSV, Excel

### üìã Section 4: Creative Performance (Facebook/Instagram only)

**–ö—Ä–µ–∞—Ç–∏–≤—ã —Å –ø—Ä–µ–≤—å—é**:

**Card Layout** (Grid 3 columns):

–ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:
1. **Preview Image** (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –†–∞–∑–º–µ—Ä: 300x300px
   - –ï—Å–ª–∏ –Ω–µ—Ç - placeholder
2. **Ad Name** - –∑–∞–≥–æ–ª–æ–≤–æ–∫
3. **Campaign Name** - –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫
4. **Ad Copy** - –ø–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤
5. **CTA** - call to action
6. **Metrics**:
   - Impressions
   - Clicks
   - CTR (%)
   - Spend (UAH)
   - Contracts
   - ROAS (x)
7. **Status Badge** - Active / Paused / Completed

**Features**:
- –§–∏–ª—å—Ç—Ä –ø–æ Campaign
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ Spend, ROAS, Contracts
- –ü–æ–∏—Å–∫ –ø–æ Ad Name
- –ö–Ω–æ–ø–∫–∞ "View Full Creative" - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–ª–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

## API Endpoints

### `GET /api/v1/analytics/ads/summary`

**Parameters**:
- `start_date` (required): string (YYYY-MM-DD)
- `end_date` (required): string (YYYY-MM-DD)
- `platforms` (optional): array of strings (google, facebook, instagram)

**Response**:
```json
{
  "total_spend": 150000.50,
  "total_contracts": 49,
  "total_revenue": 1696599.00,
  "roas": 11.31,
  "prev_period": {
    "total_spend": 120000.00,
    "total_contracts": 35,
    "total_revenue": 1200000.00,
    "roas": 10.00
  },
  "change": {
    "spend_pct": 25.0,
    "contracts_pct": 40.0,
    "revenue_pct": 41.4,
    "roas_pct": 13.1
  }
}
```

### `GET /api/v1/analytics/ads/daily-trend`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string
- `platforms` (optional): array of strings

**Response**:
```json
{
  "data": [
    {
      "date": "2025-10-01",
      "spend": 5000.00,
      "revenue": 50000.00,
      "contracts": 2,
      "roas": 10.0
    },
    ...
  ]
}
```

### `GET /api/v1/analytics/ads/campaigns`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string
- `platforms` (optional): array of strings
- `sort_by` (optional): string (spend, revenue, roas, contracts)
- `sort_order` (optional): string (asc, desc)
- `page` (optional): integer
- `limit` (optional): integer

**Response**:
```json
{
  "data": [
    {
      "platform": "google",
      "campaign_id": "12345",
      "campaign_name": "Performance Max - –ü–ö–û 2025",
      "spend": 50000.00,
      "impressions": 100000,
      "clicks": 5000,
      "ctr": 5.0,
      "leads": 100,
      "cpl": 500.00,
      "contracts": 21,
      "revenue": 972407.00,
      "roas": 19.45
    },
    ...
  ],
  "pagination": {
    "page": 1,
    "limit": 25,
    "total": 10,
    "total_pages": 1
  }
}
```

### `GET /api/v1/analytics/ads/creatives`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string
- `platforms` (optional): array (facebook, instagram only)
- `campaign_id` (optional): string

**Response**:
```json
{
  "data": [
    {
      "ad_id": "67890",
      "ad_name": "Lager_school_Kyiv - Creative 1",
      "campaign_name": "Lager_school_Kyiv",
      "platform": "instagram",
      "image_url": "https://...fb_ad_images/67890.jpg",
      "ad_copy": "–õ—ñ—Ç–Ω—ñ–π —Ç–∞–±—ñ—Ä –¥–ª—è –¥—ñ—Ç–µ–π...",
      "cta": "–î—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ",
      "status": "active",
      "impressions": 50000,
      "clicks": 2500,
      "ctr": 5.0,
      "spend": 10000.00,
      "contracts": 7,
      "roas": 19.55
    },
    ...
  ]
}
```

---

# 2Ô∏è‚É£ PAGE: `/analytics/data-analytics` - –û–±—â–∞—è –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ì–ª–∞–≤–Ω–∞—è dashboard —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –æ–±—â–µ–π –∫–∞—Ä—Ç–∏–Ω–æ–π –ø–æ –í–°–ï–ú –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º (–Ω–µ —Ç–æ–ª—å–∫–æ —Ä–µ–∫–ª–∞–º–∞)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –°—Ç—Ä–∞–Ω–∏—Ü—ã

### üìä Section 1: Global KPI Cards (Top)

**6 –∫–∞—Ä—Ç–æ—á–µ–∫**:

1. **Total Contracts**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 473 (–≤—Å–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã)
   - –ü–µ—Ä–∏–æ–¥: –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ

2. **Total Revenue**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 25.1M UAH (–≤—Å—è –≤—ã—Ä—É—á–∫–∞)
   - –ü–µ—Ä–∏–æ–¥: –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ

3. **Attributed Contracts**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 49 (10.36%)
   - Breakdown: —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º vs –±–µ–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ

4. **Attributed Revenue**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 1.7M UAH (6.75%)
   - Breakdown: —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º vs –±–µ–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ

5. **Avg Contract Value**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 53,141 UAH
   - –ü–µ—Ä–∏–æ–¥: –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ

6. **Avg Days to Close**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 7.5 –¥–Ω–µ–π (–¥–ª—è attributed)
   - Breakdown: –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ

### üìà Section 2: Charts

**Chart 1: Contracts & Revenue by Day (Combo Chart)**
- X-axis: –¥–∞—Ç–∞
- Y-axis (left): Contracts (bar chart)
- Y-axis (right): Revenue (line chart)
- Colors: bars (blue), line (green)
- Tooltip: –¥–∞—Ç–∞, contracts, revenue, avg contract value

**Chart 2: Contracts by Source (Stacked Bar Chart)**
- X-axis: –¥–∞—Ç–∞ (–Ω–µ–¥–µ–ª—å–Ω—ã–µ –±–∞—Ä—ã)
- Y-axis: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- Stacks: Google, Facebook, Instagram, Email, Viber, Telegram, Event, Direct, Organic
- Colors: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- Tooltip: –¥–∞—Ç–∞, source, contracts, % –æ—Ç total

**Chart 3: Revenue Distribution (Treemap)**
- Rectangles: –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (—Ä–∞–∑–º–µ—Ä = revenue)
- Colors: –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
- Labels: source name, revenue, % –æ—Ç total
- Click: drill-down –≤ campaigns

**Chart 4: Conversion Funnel (Funnel Chart)**
- Steps:
  1. Impressions (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ)
  2. Clicks
  3. Leads
  4. Contracts
- Values: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ + % conversion –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
- Colors: gradient –æ—Ç —Å–∏–Ω–µ–≥–æ –∫ –∑–µ–ª–µ–Ω–æ–º—É

### üìã Section 3: Platform Performance Table

**Columns**:
1. Platform - —Å –∏–∫–æ–Ω–∫–æ–π
2. Contracts - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
3. Contracts % - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç total
4. Revenue (UAH) - –≤—ã—Ä—É—á–∫–∞
5. Revenue % - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç total
6. Avg Contract (UAH) - —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫
7. Avg Days to Close - —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
8. Top Campaign - –ª—É—á—à–∞—è –∫–∞–º–ø–∞–Ω–∏—è (–ø–æ revenue)
9. Trend - —Å–ø–∞—Ä–∫–ª–∞–π–Ω –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π

**Features**:
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º
- –§–∏–ª—å—Ç—Ä—ã: Date Range
- –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫ (–ø–æ ROAS –µ—Å–ª–∏ –µ—Å—Ç—å)
- –ö–ª–∏–∫ –Ω–∞ Platform - –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

### üìä Section 4: Geographic Distribution (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ)

**Map Chart**:
- –ö–∞—Ä—Ç–∞ –£–∫—Ä–∞–∏–Ω—ã (–∏–ª–∏ –º–∏—Ä–∞)
- Heatmap: –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —Ü–≤–µ—Ç–∞ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- Tooltip: –≥–æ—Ä–æ–¥, contracts, revenue
- Zoom: –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–µ–≥–∏–æ–Ω

**Top Cities Table**:
1. City Name
2. Contracts
3. Revenue
4. Avg Contract
5. Top Source

## API Endpoints

### `GET /api/v1/analytics/data-analytics/summary`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "total_contracts": 473,
  "total_revenue": 25142227.00,
  "attributed_contracts": 49,
  "attributed_contracts_pct": 10.36,
  "attributed_revenue": 1696599.00,
  "attributed_revenue_pct": 6.75,
  "avg_contract_value": 53141.00,
  "avg_days_to_close": 7.5,
  "prev_period": { ... },
  "change": { ... }
}
```

### `GET /api/v1/analytics/data-analytics/daily-trend`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "data": [
    {
      "date": "2025-10-01",
      "total_contracts": 10,
      "total_revenue": 500000.00,
      "attributed_contracts": 2,
      "attributed_revenue": 100000.00
    },
    ...
  ]
}
```

### `GET /api/v1/analytics/data-analytics/contracts-by-source`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string
- `group_by` (optional): string (daily, weekly, monthly)

**Response**:
```json
{
  "data": [
    {
      "date": "2025-10-01",
      "google": 2,
      "facebook": 1,
      "instagram": 1,
      "email": 0,
      "viber": 0,
      "telegram": 0,
      "event": 0,
      "direct": 3,
      "organic": 2,
      "other": 1
    },
    ...
  ]
}
```

### `GET /api/v1/analytics/data-analytics/platforms`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "data": [
    {
      "platform": "google",
      "contracts": 21,
      "contracts_pct": 42.86,
      "revenue": 972407.00,
      "revenue_pct": 57.32,
      "avg_contract": 46305.00,
      "avg_days_to_close": 8.6,
      "top_campaign": "Performance Max - –ü–ö–û 2025",
      "trend": [1, 2, 1, 3, 2, 4, 3, 2, 1, 2] // last 30 days
    },
    ...
  ]
}
```

### `GET /api/v1/analytics/data-analytics/funnel`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "funnel": [
    {
      "stage": "impressions",
      "value": 1000000,
      "conversion_rate": null
    },
    {
      "stage": "clicks",
      "value": 50000,
      "conversion_rate": 5.0
    },
    {
      "stage": "leads",
      "value": 1000,
      "conversion_rate": 2.0
    },
    {
      "stage": "contracts",
      "value": 49,
      "conversion_rate": 4.9
    }
  ]
}
```

---

# 3Ô∏è‚É£ PAGE: `/analytics/contracts` - –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏ –ê—Ç—Ä–∏–±—É—Ü–∏—è

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –∫–∞–∂–¥–æ–º—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É —Å –ø–æ–ª–Ω–æ–π –∞—Ç—Ä–∏–±—É—Ü–∏–µ–π –∏—Å—Ç–æ—á–Ω–∏–∫–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –°—Ç—Ä–∞–Ω–∏—Ü—ã

### üìä Section 1: KPI Cards (Top)

**4 –∫–∞—Ä—Ç–æ—á–∫–∏**:

1. **Total Contracts**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 473
   - Breakdown: —Å attribution (49) vs –±–µ–∑ attribution (424)
   - Pie chart –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏

2. **Total Revenue**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 25.1M UAH
   - Breakdown: attributed (1.7M) vs unattributed (23.4M)
   - Pie chart –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏

3. **Attribution Rate**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 10.36% (by count), 6.75% (by revenue)
   - –î–∏–Ω–∞–º–∏–∫–∞: % –∏–∑–º–µ–Ω–µ–Ω–∏–µ
   - Target: 15% (progress bar)

4. **Top Performing Platform**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: Google (21 contracts, 972K UAH)
   - Second: Instagram (9 contracts, 232K UAH)
   - Badge: "Top Performer"

### üìà Section 2: Charts

**Chart 1: Attribution Breakdown (Donut Chart)**
- Inner ring: contracts (count)
- Outer ring: revenue (UAH)
- Slices: –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º (Google, Facebook, Instagram, Email, Viber, Telegram, Event, Unattributed)
- Tooltip: platform, contracts, revenue, % –æ—Ç total
- Center label: "10.36% Attributed"

**Chart 2: Days to Close Distribution (Histogram)**
- X-axis: days to close (0-5, 6-10, 11-15, 16-20, 21-30, 30+)
- Y-axis: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- Bars: —Ü–≤–µ—Ç –æ—Ç –∑–µ–ª–µ–Ω–æ–≥–æ (fast) –∫ –∫—Ä–∞—Å–Ω–æ–º—É (slow)
- Tooltip: range, contracts, avg contract value

**Chart 3: Contract Value Distribution (Box Plot)**
- –ü–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º (Google, Facebook, Instagram, Email, Viber, etc.)
- Y-axis: contract value (UAH)
- Box: Q1, median, Q3
- Whiskers: min, max
- Outliers: dots
- Tooltip: platform, min, Q1, median, Q3, max

**Chart 4: Attribution Timeline (Gantt Chart)**
- X-axis: –¥–∞—Ç–∞
- Y-axis: –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = –∫–æ–Ω—Ç—Ä–∞–∫—Ç)
- Bars: –æ—Ç –¥–∞—Ç—ã –ø–µ—Ä–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –¥–æ –¥–∞—Ç—ã –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- Colors: –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
- Tooltip: client_id, platform, campaign, lead_date, contract_date, days_to_close

### üìã Section 3: Contracts Table (Main)

**Columns**:
1. Contract ID - –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π
2. Client ID - –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π
3. Contract Date - –¥–∞—Ç–∞
4. Contract Amount (UAH) - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–æ
5. Platform - badge —Å –∏–∫–æ–Ω–∫–æ–π
6. Campaign - –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è
7. Ad Name - truncated —Å tooltip
8. Lead Date - –¥–∞—Ç–∞
9. Days to Close - —Ü–≤–µ—Ç: –∑–µ–ª–µ–Ω—ã–π <7, –∂–µ–ª—Ç—ã–π 7-14, –∫—Ä–∞—Å–Ω—ã–π >14
10. UTM Source - badge
11. UTM Campaign - truncated
12. Actions - –∫–Ω–æ–ø–∫–∏ (View Details, Export)

**Features**:
- **Multi-filter**:
  - Platform (multiselect)
  - Date Range (–¥–≤–æ–π–Ω–æ–π picker)
  - Contract Amount Range (slider)
  - Days to Close Range (slider)
  - Campaign (autocomplete search)
  - Attribution Status (All / Attributed / Unattributed)
- **Advanced Search**: –ø–æ client_id, campaign, ad_name
- **Sorting**: –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º
- **Pagination**: 10, 25, 50, 100, 500 –∑–∞–ø–∏—Å–µ–π
- **Bulk Actions**: Export Selected, Compare Selected
- **Export**: CSV, Excel, PDF (with details)

### üìã Section 4: Contract Details Modal

**–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ Contract ID**:

**Tabs**:

1. **Overview**:
   - Contract Info (id, date, amount, status)
   - Client Info (id, name if available, email if available)
   - Attribution Info (platform, campaign, ad, source)
   - Timeline (visual timeline –æ—Ç –ø–µ—Ä–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –¥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞)

2. **All Client Events**:
   - –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –∫–ª–∏–µ–Ω—Ç–∞ (id_source)
   - Columns: event_date, event_type, utm_source, utm_campaign, utm_medium, code (JSON)
   - Highlight: —Å–æ–±—ã—Ç–∏–µ –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–≤–µ–ª–æ –∫ –∞—Ç—Ä–∏–±—É—Ü–∏–∏

3. **Campaign Details**:
   - Campaign Info (name, platform, status)
   - Campaign Metrics (spend, impressions, clicks, leads, contracts, ROAS)
   - Other Contracts from this Campaign (—Å–ø–∏—Å–æ–∫)

4. **Creative Preview** (–µ—Å–ª–∏ Facebook/Instagram):
   - Preview Image
   - Ad Copy
   - CTA
   - Ad Metrics

## API Endpoints

### `GET /api/v1/analytics/contracts/summary`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "total_contracts": 473,
  "total_revenue": 25142227.00,
  "attributed_contracts": 49,
  "attributed_contracts_pct": 10.36,
  "attributed_revenue": 1696599.00,
  "attributed_revenue_pct": 6.75,
  "unattributed_contracts": 424,
  "unattributed_revenue": 23445628.00,
  "top_platform": {
    "platform": "google",
    "contracts": 21,
    "revenue": 972407.00
  },
  "second_platform": {
    "platform": "instagram",
    "contracts": 9,
    "revenue": 232253.00
  }
}
```

### `GET /api/v1/analytics/contracts/list`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string
- `platforms` (optional): array of strings
- `min_amount` (optional): number
- `max_amount` (optional): number
- `min_days` (optional): number
- `max_days` (optional): number
- `attribution_status` (optional): string (all, attributed, unattributed)
- `search` (optional): string
- `sort_by` (optional): string
- `sort_order` (optional): string (asc, desc)
- `page` (optional): integer
- `limit` (optional): integer

**Response**:
```json
{
  "data": [
    {
      "contract_id": "ns_123456",
      "client_id": "4175600",
      "contract_date": "2025-10-10",
      "contract_amount": 45720.00,
      "platform": "instagram",
      "campaign_name": "Lager_school_Kyiv",
      "ad_name": null,
      "lead_date": "2025-09-28",
      "days_to_close": 12,
      "utm_source": "Instagram_Feed",
      "utm_campaign": "Lager_school_Kyiv",
      "utm_medium": "cpc"
    },
    ...
  ],
  "pagination": { ... }
}
```

### `GET /api/v1/analytics/contracts/{contract_id}`

**Response**:
```json
{
  "contract": {
    "contract_id": "ns_123456",
    "client_id": "4175600",
    "contract_date": "2025-10-10T12:00:00Z",
    "contract_amount": 45720.00,
    "status": "completed"
  },
  "attribution": {
    "platform": "instagram",
    "campaign_id": "67890",
    "campaign_name": "Lager_school_Kyiv",
    "ad_id": null,
    "ad_name": null,
    "adset_name": null,
    "utm_source": "Instagram_Feed",
    "utm_campaign": "Lager_school_Kyiv",
    "utm_medium": "cpc",
    "utm_term": null,
    "utm_content": null
  },
  "timeline": {
    "first_event_date": "2025-09-28T10:00:00Z",
    "lead_date": "2025-09-28T10:00:00Z",
    "contract_date": "2025-10-10T12:00:00Z",
    "days_to_close": 12
  }
}
```

### `GET /api/v1/analytics/contracts/{contract_id}/events`

**Response**:
```json
{
  "events": [
    {
      "event_id": "ia_789",
      "event_date": "2025-09-28T10:00:00Z",
      "event_type": "lead",
      "id_source": "src_111",
      "utm_source": "Instagram_Feed",
      "utm_campaign": "Lager_school_Kyiv",
      "utm_medium": "cpc",
      "code": {
        "fclid": "fb_click_12345",
        "utm_source": "Instagram_Feed",
        "utm_campaign": "Lager_school_Kyiv",
        ...
      },
      "is_attributed": true
    },
    ...
  ]
}
```

### `GET /api/v1/analytics/contracts/attribution-breakdown`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "platforms": [
    {
      "platform": "google",
      "contracts": 21,
      "contracts_pct": 42.86,
      "revenue": 972407.00,
      "revenue_pct": 57.32
    },
    ...
  ],
  "unattributed": {
    "contracts": 424,
    "contracts_pct": 89.64,
    "revenue": 23445628.00,
    "revenue_pct": 93.25
  }
}
```

### `GET /api/v1/analytics/contracts/days-to-close-distribution`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "buckets": [
    {
      "range": "0-5",
      "contracts": 15,
      "avg_contract_value": 35000.00
    },
    {
      "range": "6-10",
      "contracts": 20,
      "avg_contract_value": 40000.00
    },
    ...
  ]
}
```

---

# 4Ô∏è‚É£ PAGE: `/analytics/marketing` - –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ (–í—Å–µ –ò—Å—Ç–æ—á–Ω–∏–∫–∏)

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ê–Ω–∞–ª–∏–∑ –í–°–ï–• –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–Ω–µ —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞): Email, Telegram, Viber, Events, Organic, Direct, etc.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –°—Ç—Ä–∞–Ω–∏—Ü—ã

### üìä Section 1: KPI Cards (Top)

**5 –∫–∞—Ä—Ç–æ—á–µ–∫**:

1. **Total Sources**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: 10+ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)
   - Top 3: Google, Instagram, Facebook
   - Breakdown: –ø–ª–∞—Ç–Ω—ã–µ vs –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ

2. **Paid Channels**
   - Contracts: 39 (Google + Facebook + Instagram)
   - Revenue: 1.42M UAH
   - Spend: ~150K UAH (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - ROAS: ~9.5x

3. **Organic Channels**
   - Contracts: 10 (Email + Telegram + Viber + Event)
   - Revenue: 277K UAH
   - Cost: 0 UAH
   - ROI: ‚àû

4. **Best Channel (by ROAS)**
   - Channel: Google Ads
   - ROAS: 19.45x
   - Contracts: 21
   - Badge: "Top Performer"

5. **Fastest Channel (by Days to Close)**
   - Channel: Event
   - Avg Days: 0.0
   - Second: Telegram (3.0 days)
   - Badge: "Fastest"

### üìà Section 2: Charts

**Chart 1: Source Comparison (Grouped Bar Chart)**
- X-axis: –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (Google, Facebook, Instagram, Email, Viber, Telegram, Event, Direct, Organic)
- Y-axis (left): Contracts (bars)
- Y-axis (right): Revenue (line)
- Grouped bars: —Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥ vs –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–µ—Ä–∏–æ–¥
- Tooltip: source, contracts (current/prev), revenue (current/prev), % change

**Chart 2: Channel Mix Evolution (Stacked Area Chart)**
- X-axis: –¥–∞—Ç–∞ (–¥–Ω–∏ –∏–ª–∏ –Ω–µ–¥–µ–ª–∏)
- Y-axis: % –æ—Ç total contracts
- Areas: –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º (stacked to 100%)
- Colors: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- Tooltip: –¥–∞—Ç–∞, source, contracts, % –æ—Ç total –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å

**Chart 3: ROI by Channel (Horizontal Bar Chart)**
- Y-axis: –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- X-axis: ROI –∏–ª–∏ ROAS (–¥–ª—è –ø–ª–∞—Ç–Ω—ã—Ö) / Revenue (–¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö)
- Bars: —Ü–≤–µ—Ç –æ—Ç –∫—Ä–∞—Å–Ω–æ–≥–æ (low) –∫ –∑–µ–ª–µ–Ω–æ–º—É (high)
- Labels: –∑–Ω–∞—á–µ–Ω–∏–µ ROI/ROAS/Revenue –Ω–∞ –±–∞—Ä–µ
- Tooltip: source, ROI/ROAS, contracts, revenue, spend (if paid)

**Chart 4: Customer Journey (Sankey Diagram)**
- Flows: –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ ‚Üí –∫ –∫–∞–º–ø–∞–Ω–∏–∏ ‚Üí –∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É
- Width: –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–µ–Ω –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- Colors: –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É
- Tooltip: source ‚Üí campaign, contracts, revenue

### üìã Section 3: Source Performance Table

**Columns**:
1. Source - badge —Å –∏–∫–æ–Ω–∫–æ–π
2. Type - –ø–ª–∞—Ç–Ω—ã–π / –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π
3. Contracts - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
4. Contracts % - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç total
5. Revenue (UAH) - –≤—ã—Ä—É—á–∫–∞
6. Revenue % - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç total
7. Avg Contract (UAH) - —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫
8. Avg Days to Close - —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è
9. Spend (UAH) - —Ä–∞—Å—Ö–æ–¥—ã (–µ—Å–ª–∏ –ø–ª–∞—Ç–Ω—ã–π)
10. ROAS / ROI - –≤–æ–∑–≤—Ä–∞—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π
11. Top Campaign - –ª—É—á—à–∞—è –∫–∞–º–ø–∞–Ω–∏—è
12. Trend - —Å–ø–∞—Ä–∫–ª–∞–π–Ω

**Features**:
- –§–∏–ª—å—Ç—Ä—ã: Type (paid/organic), Date Range
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: All / Paid / Organic
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º
- –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞: –ø–æ ROAS/ROI
- Export: CSV, Excel

### üìã Section 4: Campaign Details by Source

**Expandable Rows**:
–ö–∞–∂–¥—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∫–∞–º–ø–∞–Ω–∏–∏:

**Email**:
- MA_Kiev_site: 2 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, 67,500 UAH
- a360-mka-progrev-lidov: 1 –∫–æ–Ω—Ç—Ä–∞–∫—Ç, 33,250 UAH
- opros_repetitor: 1 –∫–æ–Ω—Ç—Ä–∞–∫—Ç, 0 UAH
- skr_kiev_site: 1 –∫–æ–Ω—Ç—Ä–∞–∫—Ç, 0 UAH

**Viber**:
- viber: 2 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, 167,040 UAH

**Telegram**:
- tgchanel: 2 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, 0 UAH

**Instagram**:
- Lager_school_Kyiv: 7 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤, 195,550 UAH
- MA_Kiev_site: 2 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞, 36,703 UAH

etc.

### üìä Section 5: Organic vs Paid Analysis

**Side by Side Comparison**:

**Left: Paid Channels**
- Total Contracts: 39
- Total Revenue: 1.42M UAH
- Total Spend: 150K UAH (estimate)
- ROAS: 9.47x
- Avg Contract: 36,415 UAH
- Avg Days: 7.5

**Right: Organic Channels**
- Total Contracts: 10
- Total Revenue: 277K UAH
- Total Spend: 0 UAH
- ROI: ‚àû
- Avg Contract: 27,700 UAH
- Avg Days: 6.9

**Bottom: Comparison Chart (Radar Chart)**
- Axes: Contracts, Revenue, Avg Contract, Speed (inverse days), Efficiency (ROAS)
- 2 polygons: Paid (blue) vs Organic (green)
- Normalized scale (0-100)

## API Endpoints

### `GET /api/v1/analytics/marketing/summary`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "total_sources": 10,
  "top_sources": ["google", "instagram", "facebook"],
  "paid_channels": {
    "contracts": 39,
    "revenue": 1423909.00,
    "spend": 150000.00,
    "roas": 9.49
  },
  "organic_channels": {
    "contracts": 10,
    "revenue": 272690.00,
    "spend": 0,
    "roi": null
  },
  "best_channel": {
    "source": "google",
    "roas": 19.45,
    "contracts": 21
  },
  "fastest_channel": {
    "source": "event",
    "avg_days": 0.0
  }
}
```

### `GET /api/v1/analytics/marketing/sources`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string
- `type` (optional): string (paid, organic, all)
- `sort_by` (optional): string
- `sort_order` (optional): string

**Response**:
```json
{
  "data": [
    {
      "source": "google",
      "type": "paid",
      "contracts": 21,
      "contracts_pct": 42.86,
      "revenue": 972407.00,
      "revenue_pct": 57.32,
      "avg_contract": 46305.00,
      "avg_days_to_close": 8.6,
      "spend": 50000.00,
      "roas": 19.45,
      "top_campaign": "Performance Max - –ü–ö–û 2025",
      "trend": [...]
    },
    ...
  ]
}
```

### `GET /api/v1/analytics/marketing/source/{source}/campaigns`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "source": "email",
  "campaigns": [
    {
      "campaign_name": "MA_Kiev_site",
      "contracts": 2,
      "revenue": 67500.00,
      "avg_contract": 33750.00,
      "avg_days": 6.0
    },
    ...
  ]
}
```

### `GET /api/v1/analytics/marketing/paid-vs-organic`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string

**Response**:
```json
{
  "paid": {
    "contracts": 39,
    "revenue": 1423909.00,
    "spend": 150000.00,
    "roas": 9.49,
    "avg_contract": 36515.00,
    "avg_days": 7.5
  },
  "organic": {
    "contracts": 10,
    "revenue": 272690.00,
    "spend": 0,
    "roi": null,
    "avg_contract": 27269.00,
    "avg_days": 6.9
  },
  "comparison": {
    "contracts_diff_pct": 290.0,
    "revenue_diff_pct": 422.2,
    "avg_contract_diff_pct": 33.9,
    "avg_days_diff_pct": 8.7
  }
}
```

### `GET /api/v1/analytics/marketing/channel-mix-trend`

**Parameters**:
- `start_date` (required): string
- `end_date` (required): string
- `group_by` (optional): string (daily, weekly, monthly)

**Response**:
```json
{
  "data": [
    {
      "date": "2025-10-01",
      "google": 2,
      "facebook": 1,
      "instagram": 1,
      "email": 0,
      "viber": 0,
      "telegram": 0,
      "event": 0,
      "direct": 3,
      "organic": 2,
      "other": 1,
      "total": 10
    },
    ...
  ]
}
```

---

## üõ†Ô∏è –û–ë–©–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### UI/UX Guidelines

1. **Design System**:
   - Use Tailwind CSS
   - Follow existing component library
   - Consistent spacing (4px grid)
   - Typography: Inter font family

2. **Colors**:
   - Primary: Blue (#3B82F6)
   - Success: Green (#10B981)
   - Warning: Yellow (#F59E0B)
   - Danger: Red (#EF4444)
   - Platform specific:
     - Google: #4285F4
     - Facebook: #1877F2
     - Instagram: #E4405F
     - Email: #EA4335
     - Telegram: #0088CC
     - Viber: #7360F2

3. **Responsive**:
   - Mobile: 320px+
   - Tablet: 768px+
   - Desktop: 1024px+
   - Large: 1440px+

4. **Loading States**:
   - Skeleton loaders –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫
   - Spinner –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
   - Progress bar –¥–ª—è —Ç–∞–±–ª–∏—Ü

5. **Error Handling**:
   - Toast notifications –¥–ª—è –æ—à–∏–±–æ–∫
   - Inline errors –¥–ª—è —Ñ–æ—Ä–º
   - Retry buttons –¥–ª—è failed requests

6. **Accessibility**:
   - ARIA labels
   - Keyboard navigation
   - Screen reader support
   - High contrast mode

### Performance Requirements

1. **Page Load**:
   - Initial render: <2s
   - Time to Interactive: <3s
   - First Contentful Paint: <1s

2. **API Response**:
   - Summary endpoints: <500ms
   - List endpoints: <1s
   - Complex queries: <2s

3. **Data Refresh**:
   - Auto-refresh: every 5 minutes (optional toggle)
   - Manual refresh button
   - Real-time updates for critical metrics (optional)

### Security

1. **Authentication**:
   - JWT tokens
   - Token refresh
   - Role-based access (Admin, Manager, Viewer)

2. **Data Protection**:
   - No sensitive data in URLs
   - Encrypted API calls (HTTPS)
   - Rate limiting

### Testing

1. **Unit Tests**:
   - Components: >80% coverage
   - Utils: >90% coverage

2. **Integration Tests**:
   - API calls
   - State management

3. **E2E Tests**:
   - Critical user flows
   - Cross-browser testing

---

## üì¶ IMPLEMENTATION CHECKLIST

### Phase 1: Core Infrastructure (Week 1)
- [ ] Setup API endpoints (all listed above)
- [ ] Create TypeScript types for all responses
- [ ] Implement authentication & authorization
- [ ] Setup error handling & logging

### Phase 2: Page 1 - Ads (Week 2)
- [ ] Implement `/analytics/ads` page
- [ ] KPI cards with summary endpoint
- [ ] Charts (4 charts)
- [ ] Campaign performance table
- [ ] Creative performance section
- [ ] Responsive design
- [ ] Unit tests

### Phase 3: Page 2 - Data Analytics (Week 3)
- [ ] Implement `/analytics/data-analytics` page
- [ ] Global KPI cards
- [ ] Charts (4 charts)
- [ ] Platform performance table
- [ ] Responsive design
- [ ] Unit tests

### Phase 4: Page 3 - Contracts (Week 4)
- [ ] Implement `/analytics/contracts` page
- [ ] KPI cards
- [ ] Charts (4 charts)
- [ ] Contracts table with filters
- [ ] Contract details modal
- [ ] Responsive design
- [ ] Unit tests

### Phase 5: Page 4 - Marketing (Week 5)
- [ ] Implement `/analytics/marketing` page
- [ ] KPI cards
- [ ] Charts (4 charts)
- [ ] Source performance table
- [ ] Paid vs Organic comparison
- [ ] Responsive design
- [ ] Unit tests

### Phase 6: Polish & Testing (Week 6)
- [ ] Cross-browser testing
- [ ] Performance optimization
- [ ] Accessibility audit
- [ ] E2E tests for all pages
- [ ] Documentation
- [ ] User acceptance testing

---

## üéØ SUCCESS METRICS

### User Engagement
- Page views per session: >5
- Avg session duration: >5 minutes
- Return visit rate: >60%

### Performance
- Page load time: <2s
- API response time: <1s
- Error rate: <1%

### Business Impact
- Time to insights: <1 minute
- Decision-making speed: +50%
- Attribution accuracy: 10.36% ‚Üí 15% (target)

---

**Prepared by**: Claude Code Assistant
**Date**: 2025-10-23
**Version**: V9 Final
**Status**: üü¢ READY FOR IMPLEMENTATION
