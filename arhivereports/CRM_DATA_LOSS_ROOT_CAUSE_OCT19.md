# üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –ü–û–¢–ï–†–Ø 86% GCLID –î–ê–ù–ù–´–•
**Date**: October 19, 2025, 22:30
**Status**: ‚úÖ –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê –ù–ê–ô–î–ï–ù–ê

---

## üìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê

### –î–∞–Ω–Ω—ã–µ –≤ RAW —Ç–∞–±–ª–∏—Ü–∞—Ö:
- ‚úÖ **381 gclid** –≤ raw.itcrm_analytics
- ‚úÖ –ü–µ—Ä–∏–æ–¥: June 19, 2025 ‚Üí October 17, 2025 (4 –º–µ—Å—è—Ü–∞)
- ‚úÖ 4,498 total analytics events

### –î–∞–Ω–Ω—ã–µ –≤ crm_requests:
- ‚ùå **53 gclid** (—Ç–æ–ª—å–∫–æ 13.9% –æ—Ç RAW!)
- ‚ùå –ü–µ—Ä–∏–æ–¥: September 9, 2025 ‚Üí October 17, 2025 (1 –º–µ—Å—è—Ü)
- ‚úÖ 16,798 total requests (–Ω–æ —Å 2014 –≥–æ–¥–∞!)

### –ü–û–¢–ï–†–ò:
- **328 gclid records LOST (86.1%)** ‚ùå

---

## üîç –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ü–†–û–ë–õ–ï–ú–ê ‚Ññ1: –í–†–ï–ú–ï–ù–ù–û–ô –†–ê–ó–†–´–í (288 gclid)

**–§–∞–∫—Ç—ã**:
```sql
-- itcrm_analytics June-August: 288 gclid ‚ùå –ù–ï –∑–∞–≥—Ä—É–∂–µ–Ω—ã
-- itcrm_analytics Sept-Oct: 93 gclid ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (53 –∏–∑ 93)
```

**–î–∏–∞–≥–Ω–æ–∑**: ETL –ø—Ä–æ—Ü–µ—Å—Å **–ù–ï –ó–ê–ì–†–£–ó–ò–õ –¥–∞–Ω–Ω—ã–µ –∑–∞ June-August 2025**

**–î–µ—Ç–∞–ª–∏**:
- raw.itcrm_analytics earliest date: **2025-06-19**
- crm_requests earliest date with gclid: **2025-09-09**
- **82 –î–ù–Ø –¥–∞–Ω–Ω—ã—Ö –û–¢–°–£–¢–°–¢–í–£–Æ–¢** –≤ crm_requests!

**–ü—Ä–∏—á–∏–Ω–∞**:
- –í–æ–∑–º–æ–∂–Ω–æ, ETL workflow –∑–∞–ø—É—â–µ–Ω —Ç–æ–ª—å–∫–æ —Å 9 —Å–µ–Ω—Ç—è–±—Ä—è
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (June-August) –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- –ù–µ—Ç backfill –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

### –ü–†–û–ë–õ–ï–ú–ê ‚Ññ2: –ù–ï–ü–û–õ–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê –¢–ï–ö–£–©–ò–• –î–ê–ù–ù–´–• (40 gclid)

**–§–∞–∫—Ç—ã**:
```sql
-- itcrm_analytics Sept-Oct: 93 gclid
-- crm_requests Sept-Oct: 53 gclid
-- –ü–û–¢–ï–†–Ø: 40 gclid (43% —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö!)
```

**–î–∏–∞–≥–Ω–æ–∑**: –î–∞–∂–µ –¥–ª—è –¢–ï–ö–£–©–ï–ì–û –ø–µ—Ä–∏–æ–¥–∞ (Sept-Oct) –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ **57%** –¥–∞–Ω–Ω—ã—Ö!

**–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑**:

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ internet_request_id:
- itcrm_analytics records —Å matching internet_request_id –≤ crm_requests: **152 gclid**
- itcrm_analytics records –ë–ï–ó matching internet_request_id: **229 gclid**
- crm_requests actual gclid in code: **53 gclid**

**–í—ã–≤–æ–¥**:
1. **229 gclid (60%)** –∏–º–µ—é—Ç internet_request_id –∫–æ—Ç–æ—Ä–æ–≥–æ –ù–ï–¢ –≤ crm_requests
2. **152 gclid (40%)** –∏–º–µ—é—Ç matching internet_request_id, –ù–û
3. –¢–æ–ª—å–∫–æ **53 gclid (13.9%)** —Ä–µ–∞–ª—å–Ω–æ –ø–æ–ø–∞–ª–∏ –≤ crm_requests.code

**–ü—Ä–∏—á–∏–Ω–∞**:
- ETL –ø—Ä–æ—Ü–µ—Å—Å –ù–ï —Å–æ–∑–¥–∞—ë—Ç crm_requests –¥–ª—è –º–Ω–æ–≥–∏—Ö internet_request_id
- –ò–ª–∏ –ª–æ–≥–∏–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —Ç–µ—Ä—è–µ—Ç gclid –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ

---

### –ü–†–û–ë–õ–ï–ú–ê ‚Ññ3: –ü–û–¢–ï–†–Ø GCLID –ü–†–ò –ê–ì–†–ï–ì–ê–¶–ò–ò (99 gclid)

**–§–∞–∫—Ç—ã**:
- itcrm_analytics —Å matching internet_request_id: **152 gclid**
- crm_requests —Å gclid: **53 gclid**
- **–ü–û–¢–ï–†–Ø –ø—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏: 99 gclid (65%)**

**–î–∏–∞–≥–Ω–æ–∑**: –õ–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è crm_requests **–¢–ï–†–Ø–ï–¢ gclid** –ø—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö itcrm_analytics —Å–æ–±—ã—Ç–∏–π –≤ –æ–¥–∏–Ω request.

**–°—Ü–µ–Ω–∞—Ä–∏–π –ø–æ—Ç–µ—Ä–∏**:
```
internet_request_id: 123456

itcrm_analytics events:
‚îú‚îÄ‚îÄ Event 1: code = {"gclid": "ABC123", "utm_source": "google"} ‚úÖ
‚îú‚îÄ‚îÄ Event 2: code = {"utm_source": "google"}
‚îî‚îÄ‚îÄ Event 3: code = {}

crm_requests aggregation:
‚îî‚îÄ‚îÄ –í—ã–±—Ä–∞–Ω–æ Event 3 (–ø—É—Å—Ç–æ–π code) ‚ùå gclid –ø–æ—Ç–µ—Ä—è–Ω!
```

**–ü—Ä–∏—á–∏–Ω–∞**:
- –õ–æ–≥–∏–∫–∞ –≤—ã–±–∏—Ä–∞–µ—Ç –ü–û–°–õ–ï–î–ù–ï–ï —Å–æ–±—ã—Ç–∏–µ (–∏–ª–∏ –ø–µ—Ä–≤–æ–µ) –≤–º–µ—Å—Ç–æ –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–ò —Å–æ–±—ã—Ç–∏–π —Å gclid
- –ù–µ—Ç –ª–æ–≥–∏–∫–∏ merge –≤—Å–µ—Ö code –ø–æ–ª–µ–π –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –í–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è DISTINCT ON –∏–ª–∏ GROUP BY —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –≤—ã–±–æ—Ä–æ–º –∑–∞–ø–∏—Å–∏

---

## üéØ –ö–û–†–ù–ï–í–´–ï –ü–†–ò–ß–ò–ù–´

### 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Backfill –ø—Ä–æ—Ü–µ—Å—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞**: itcrm_analytics –∏–º–µ–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å June 19, 2025, –Ω–æ crm_requests –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å Sept 9, 2025.

**–†–µ—à–µ–Ω–∏–µ**:
```sql
-- –°–æ–∑–¥–∞—Ç—å backfill –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
INSERT INTO dashboards.crm_requests (...)
SELECT ...
FROM raw.itcrm_analytics
WHERE request_created_at >= '2025-06-19'::DATE
  AND request_created_at < '2025-09-09'::DATE;
```

### 2. –ù–µ–ø–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ internet_request_id

**–ü—Ä–æ–±–ª–µ–º–∞**: 229 gclid (60%) –∏–º–µ—é—Ç internet_request_id –∫–æ—Ç–æ—Ä–æ–≥–æ –ù–ï–¢ –≤ crm_requests.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- JOIN —É—Å–ª–æ–≤–∏–µ —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ–µ (INNER JOIN –≤–º–µ—Å—Ç–æ LEFT JOIN)
- –§–∏–ª—å—Ç—Ä WHERE —É–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏
- itcrm_internet_request —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —ç—Ç–∏ request_id

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ETL –ª–æ–≥–∏–∫—É —Å–æ–∑–¥–∞–Ω–∏—è crm_requests:
```sql
-- –ù–∞–π—Ç–∏ missing internet_request_ids
SELECT DISTINCT ia.internet_request_id
FROM raw.itcrm_analytics ia
WHERE ia.code->>'gclid' != ''
  AND ia.code->>'gclid' IS NOT NULL
  AND ia.internet_request_id::TEXT NOT IN (
    SELECT internet_request_id
    FROM dashboards.crm_requests
    WHERE internet_request_id IS NOT NULL
  )
ORDER BY ia.internet_request_id
LIMIT 10;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –æ–Ω–∏ –≤ raw.itcrm_internet_request
SELECT COUNT(*)
FROM raw.itcrm_internet_request
WHERE request_id::TEXT IN (...);
```

### 3. –ü–æ—Ç–µ—Ä—è gclid –ø—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: –õ–æ–≥–∏–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –ë–ï–ó gclid –≤–º–µ—Å—Ç–æ —Å–æ–±—ã—Ç–∏—è –° gclid.

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ (–≥–∏–ø–æ—Ç–µ–∑–∞)**:
```sql
-- –ü–õ–û–•–û: –±–µ—Ä—ë—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å
SELECT DISTINCT ON (internet_request_id)
  *
FROM raw.itcrm_analytics
ORDER BY internet_request_id, request_created_at DESC; -- –∏–ª–∏ ASC
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞**:
```sql
-- –•–û–†–û–®–û: –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏ —Å gclid
SELECT DISTINCT ON (internet_request_id)
  internet_request_id,
  COALESCE(
    code,
    '{}'::jsonb
  ) as code,
  ...
FROM raw.itcrm_analytics
ORDER BY
  internet_request_id,
  CASE
    WHEN code->>'gclid' != '' AND code->>'gclid' IS NOT NULL THEN 1
    WHEN code->>'fb_lead_id' != '' THEN 2
    WHEN code ? 'utm_source' THEN 3
    ELSE 4
  END ASC,
  request_created_at DESC;
```

**–ò–ª–∏ MERGE –≤—Å–µ—Ö code –ø–æ–ª–µ–π**:
```sql
-- –õ–£–ß–®–ï: –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ code –ø–æ–ª—è –∏–∑ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
SELECT
  internet_request_id,
  jsonb_object_agg(
    key,
    value
  ) as code -- —Å–ª–∏—Ç—å –≤—Å–µ –∫–ª—é—á–∏ –∏–∑ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
FROM (
  SELECT
    internet_request_id,
    jsonb_each.key,
    jsonb_each.value
  FROM raw.itcrm_analytics,
       jsonb_each(code)
  GROUP BY internet_request_id, key
)
GROUP BY internet_request_id;
```

---

## üìã –ó–ê–î–ê–ß–ò –î–õ–Ø CRM –ö–û–ú–ê–ù–î–´

### –ó–ê–î–ê–ß–ê ‚Ññ1: Backfill –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (URGENT)

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–≥—Ä—É–∑–∏—Ç—å 288 gclid records –∑–∞ –ø–µ—Ä–∏–æ–¥ June 19 - Sept 8, 2025.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ CRITICAL

**SQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö**:
```sql
SELECT
  request_created_at::DATE as date,
  COUNT(*) as records_with_gclid
FROM raw.itcrm_analytics
WHERE code->>'gclid' != ''
  AND code->>'gclid' IS NOT NULL
  AND request_created_at >= '2025-06-19'::DATE
  AND request_created_at < '2025-09-09'::DATE
GROUP BY request_created_at::DATE
ORDER BY date;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: crm_requests –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 381 gclid (–≤–º–µ—Å—Ç–æ 53).

---

### –ó–ê–î–ê–ß–ê ‚Ññ2: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (HIGH)

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–∑–º–µ–Ω–∏—Ç—å ETL –ø—Ä–æ—Ü–µ—Å—Å crm_requests —á—Ç–æ–±—ã –ü–†–ò–û–†–ò–¢–ò–ó–ò–†–û–í–ê–¢–¨ –∑–∞–ø–∏—Å–∏ —Å tracking –¥–∞–Ω–Ω—ã–º–∏ (gclid, fb_lead_id, UTM).

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü† HIGH

**–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**:
- 152 gclid —Å matching internet_request_id ‚Üí —Ç–æ–ª—å–∫–æ 53 –ø–æ–ø–∞–ª–∏ –≤ crm_requests
- **99 gclid (65%) –ø–æ—Ç–µ—Ä—è–Ω—ã –ø—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏**

**–¢—Ä–µ–±—É–µ–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ**:
1. –ü—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö itcrm_analytics —Å–æ–±—ã—Ç–∏–π –≤ –æ–¥–∏–Ω crm_requests:
   - –í—ã–±–∏—Ä–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ —Å gclid (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –ò–ª–∏ –≤—ã–±–∏—Ä–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ —Å fb_lead_id (–µ—Å–ª–∏ –Ω–µ—Ç gclid)
   - –ò–ª–∏ –≤—ã–±–∏—Ä–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ —Å utm_source (–µ—Å–ª–∏ –Ω–µ—Ç –¥—Ä—É–≥–∏—Ö)
   - –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ò –û–î–ù–û–ì–û –Ω–µ—Ç - –±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–±—ã—Ç–∏–µ

2. –ò–ª–∏ (–ª—É—á—à–µ): MERGE –≤—Å–µ code –ø–æ–ª—è –∏–∑ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –æ–¥–Ω–æ–≥–æ internet_request_id

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ 152 gclid –¥–æ–ª–∂–Ω—ã –ø–æ–ø–∞—Å—Ç—å –≤ crm_requests.

---

### –ó–ê–î–ê–ß–ê ‚Ññ3: –î–æ–±–∞–≤–∏—Ç—å missing internet_request_id (MEDIUM)

**–û–ø–∏—Å–∞–Ω–∏–µ**: –í—ã—è—Å–Ω–∏—Ç—å –ø–æ—á–µ–º—É 229 gclid (60%) –∏–º–µ—é—Ç internet_request_id –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ crm_requests.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° MEDIUM

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```sql
-- –°–ø–∏—Å–æ–∫ internet_request_id –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ crm_requests
SELECT DISTINCT ia.internet_request_id
FROM raw.itcrm_analytics ia
WHERE ia.code->>'gclid' != ''
  AND ia.code->>'gclid' IS NOT NULL
  AND ia.internet_request_id::TEXT NOT IN (
    SELECT internet_request_id
    FROM dashboards.crm_requests
    WHERE internet_request_id IS NOT NULL
  )
ORDER BY ia.internet_request_id;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –æ–Ω–∏ –≤ itcrm_internet_request
SELECT
  'Missing in crm_requests' as status,
  COUNT(*) as count
FROM raw.itcrm_internet_request
WHERE request_id IN (...);
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –§–∏–ª—å—Ç—Ä –≤ ETL —É–¥–∞–ª—è–µ—Ç —ç—Ç–∏ requests (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ "–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ" –∑–∞—è–≤–∫–∏)
- –ù–µ—Ç —Å–≤—è–∑–∏ –≤ itcrm_internet_request_relation
- –ù–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ itcrm_internet_request

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å ETL –ª–æ–≥–∏–∫—É.

---

### –ó–ê–î–ê–ß–ê ‚Ññ4: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (LOW)

**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å alert –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ itcrm_analytics –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ crm_requests.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ LOW

**–ú–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**:
```sql
-- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å < 5%
SELECT
  ROUND(100.0 * (
    (SELECT COUNT(*) FROM raw.itcrm_analytics WHERE code->>'gclid' != '')
    -
    (SELECT COUNT(*) FROM dashboards.crm_requests WHERE code->>'gclid' != '')
  ) / NULLIF((SELECT COUNT(*) FROM raw.itcrm_analytics WHERE code->>'gclid' != ''), 0), 2)
  as percent_data_loss;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: Alert –µ—Å–ª–∏ data loss > 5%.

---

## ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –ü–†–ê–í–ò–õ–¨–ù–û

1. ‚úÖ raw.itcrm_analytics –°–û–î–ï–†–ñ–ò–¢ –í–°–ï –î–ê–ù–ù–´–ï (381 gclid)
2. ‚úÖ Tracking —Ä–∞–±–æ—Ç–∞–µ—Ç —Å June 19, 2025
3. ‚úÖ code –ø–æ–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –≤ RAW —Ç–∞–±–ª–∏—Ü–µ
4. ‚úÖ 53 gclid (13.9%) —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ crm_requests

---

## üìä –ò–¢–û–ì–û–í–´–ï –¶–ò–§–†–´

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | % |
|---------|----------|---|
| **RAW gclid (–∏—Ç–æ–≥–æ)** | 381 | 100% |
| **–ü–æ—Ç–µ—Ä—è–Ω–æ: June-Aug backfill** | 288 | 75.6% |
| **–ü–æ—Ç–µ—Ä—è–Ω–æ: missing internet_request_id** | 229 | 60.1% |
| **–ü–æ—Ç–µ—Ä—è–Ω–æ: –∞–≥—Ä–µ–≥–∞—Ü–∏—è** | 99 | 26.0% |
| **–ó–∞–≥—Ä—É–∂–µ–Ω–æ –≤ crm_requests** | 53 | 13.9% |

**–ò–¢–û–ì–û –ü–û–¢–ï–†–Ø–ù–û: 328 gclid (86.1%)** ‚ùå

---

## üéØ –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø

1. üî¥ **–ó–ê–î–ê–ß–ê ‚Ññ1** (Backfill) - –ù–ï–ú–ï–î–õ–ï–ù–ù–û
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç 288 gclid (75.6%)
   - –ü—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ø–µ—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ June-Aug

2. üü† **–ó–ê–î–ê–ß–ê ‚Ññ2** (–ê–≥—Ä–µ–≥–∞—Ü–∏—è) - –í–´–°–û–ö–ò–ô
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç 99 gclid (26.0%)
   - –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è ETL –ª–æ–≥–∏–∫–∏

3. üü° **–ó–ê–î–ê–ß–ê ‚Ññ3** (Missing ID) - –°–†–ï–î–ù–ò–ô
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –¥–æ 229 gclid (60.1%)
   - –¢—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—á–µ–º—É –Ω–µ—Ç —Å–≤—è–∑–∏

4. üü¢ **–ó–ê–î–ê–ß–ê ‚Ññ4** (–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥) - –ù–ò–ó–ö–ò–ô
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –±—É–¥—É—â–∏–µ –ø–æ—Ç–µ—Ä–∏
   - –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

---

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –í–°–ï–• –ø—Ä–æ–±–ª–µ–º: 381 gclid (100%) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ crm_requests!** ‚úÖ
